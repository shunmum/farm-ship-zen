# デモアカウントセットアップ手順

FarmShipのデモ環境を構築するための手順です。

## 概要

- **デモアカウント**: demo@farmship.example
- **パスワード**: demo123456
- **含まれるデータ**:
  - 商品マスター: 8商品（トマト、きゅうり、なす、レタスなど）
  - 顧客: 5件（卸売業者、個人顧客、レストランなど）
  - 作業日誌: 2024年1月〜12月の48件
  - 配送ゾーン設定: 5ゾーン（関東、中部、関西、北海道・東北、九州・沖縄）
  - ゾーン別送料: 各ゾーンのヤマト運輸料金設定

## セットアップ手順

### ステップ1: Supabaseでデモユーザーを作成

1. Supabase Dashboardにアクセス
2. **Authentication** → **Users** に移動
3. **Add user** ボタンをクリック
4. 以下の情報を入力:
   - Email: `demo@farmship.example`
   - Password: `demo123456`
   - Auto Confirm User: **有効にする** ✓
5. **Create user** をクリック
6. 作成されたユーザーの **UID** をコピー (例: `a1b2c3d4-e5f6-7890-abcd-ef1234567890`)

### ステップ2: SQLスクリプトを編集

1. `supabase/seed-demo-data.sql` を開く
2. 5行目の `demo_user_id` の値を、ステップ1でコピーしたUIDに置き換える:

```sql
DECLARE
  demo_user_id UUID := 'a1b2c3d4-e5f6-7890-abcd-ef1234567890'; -- ここを実際のUIDに変更
```

### ステップ3: SQLスクリプトを実行

1. Supabase Dashboard → **SQL Editor** に移動
2. **New query** をクリック
3. `supabase/seed-demo-data.sql` の内容を全てコピー&ペースト
4. **Run** をクリックして実行

### ステップ4: 動作確認

1. アプリケーションにログイン
   - Email: `demo@farmship.example`
   - Password: `demo123456`

2. 以下のページでデータが表示されることを確認:
   - **商品マスター**: 8商品が登録済み
   - **顧客管理**: 5件の顧客が表示される
   - **作業日誌**: 2024年のデータが48件表示される
   - **設定 > ゾーン管理**: 5つのゾーンが設定済み
   - **設定 > ゾーン別料金**: 各ゾーンの送料が設定済み

## デモデータの内容

### 商品マスター (8商品)
- トマト (¥500/kg) - 甘みの強い完熟トマト
- きゅうり (¥300/kg) - 新鮮な朝どりきゅうり
- なす (¥400/kg) - 艶のある夏なす
- レタス (¥250/個) - サラダ用フリルレタス
- ほうれん草 (¥350/kg) - 栄養たっぷりほうれん草
- じゃがいも (¥200/kg) - メークイン
- にんじん (¥250/kg) - 甘い春にんじん
- いちご (¥1,200/kg) - 甘くて大粒のいちご

### 顧客 (5件)
1. **田中商店** (卸売) - 東京都千代田区
2. **山田青果** (卸売) - 大阪府大阪市
3. **佐藤太郎** (個人) - 東京都渋谷区
4. **鈴木農園** (卸売) - 北海道札幌市
5. **高橋レストラン** (飲食店) - 福岡県福岡市

### 作業日誌 (2024年 48件)
- 月ごとに3〜4件の作業記録
- 手動入力とAI入力の両方を含む
- 実際の農作業の流れを再現:
  - 1月: 冬野菜収穫、春野菜準備
  - 2月-3月: トマト定植、じゃがいも植え付け
  - 4月-5月: 夏野菜定植、収穫開始
  - 6月-8月: 収穫ピーク
  - 9月-10月: 秋野菜準備、いちご定植
  - 11月-12月: 冬野菜収穫、いちご初収穫

### 配送ゾーン設定
1. **関東** (7都県): 東京、神奈川、千葉、埼玉、茨城、栃木、群馬
2. **中部** (7県): 愛知、静岡、岐阜、三重、長野、新潟、山梨
3. **関西** (6府県): 大阪、京都、兵庫、奈良、滋賀、和歌山
4. **北海道・東北** (7道県): 北海道、青森、岩手、宮城、秋田、山形、福島
5. **九州・沖縄** (8県): 福岡、佐賀、長崎、熊本、大分、宮崎、鹿児島、沖縄

### ゾーン別送料 (ヤマト運輸)
- 関東: 60サイズ ¥800〜
- 中部: 60サイズ ¥900〜
- 関西: 60サイズ ¥1,000〜
- 北海道・東北: 60サイズ ¥1,500〜
- 九州・沖縄: 60サイズ ¥1,300〜
- クール便追加料金: 60-100サイズ +¥220、120-160サイズ +¥330

## デモで確認できる機能

### 1. 作業日誌の年次比較
- 「作業日誌」→「年次比較」タブ
- 2024年のデータを月ごとに表示
- （2023年のデータがないため、前年比較は表示されません）

### 2. カレンダービュー
- 「作業日誌」→「タイムライン」タブ → 「カレンダー表示」
- 月ごとのカレンダー形式で作業を確認

### 3. ガントチャート
- 「作業日誌」→「タイムライン」タブ → 「ガントチャート」
- 圃場ごとの作業スケジュールを視覚化

### 4. ゾーン別送料計算
- 「設定」→「ゾーン管理」で都道府県の割り当て確認
- 「設定」→「ゾーン別料金」で各ゾーンの料金確認
- 注文作成時に自動で送料が計算される

## トラブルシューティング

### データが表示されない場合

1. **ユーザーIDが正しいか確認**
   - SQLスクリプト内の `demo_user_id` が、実際に作成したユーザーのUIDと一致しているか確認

2. **RLSポリシーの確認**
   - Supabase Dashboard → **Database** → **Policies** で各テーブルのRLSが有効になっているか確認

3. **ログイン状態の確認**
   - ブラウザの開発者ツール (F12) → **Application** → **Local Storage** で認証トークンを確認
   - 必要に応じてログアウト→再ログイン

### SQLエラーが発生する場合

1. **構文エラー**
   - SQLスクリプトをコピーする際に、文字化けや改行がおかしくなっていないか確認

2. **外部キー制約エラー**
   - `demo_user_id` が実在しないUUIDの場合に発生
   - ステップ1で作成したユーザーのUIDを正しくコピーしているか確認

3. **重複エラー**
   - 既にデータが投入されている場合、重複エラーが発生する可能性がある
   - その場合は、該当テーブルのデータを削除してから再実行

## デモアカウントの削除方法

デモアカウントが不要になった場合:

1. Supabase Dashboard → **Authentication** → **Users**
2. `demo@farmship.example` を検索
3. ユーザーを選択して **Delete user** をクリック
4. 関連データは自動的に削除されます（CASCADE設定）

## 注意事項

- デモアカウントは開発環境・テスト環境専用です
- 本番環境では使用しないでください
- パスワードは簡易的なものなので、公開しないでください
